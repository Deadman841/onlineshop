<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>添加收货地址 - layui</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../lib/layui-v2.6.3/css/layui.css" media="all">
    <link rel="stylesheet" href="../../css/public.css" media="all">
    <style>
        body {
            background-color: #ffffff;
        }
        .layuimini-form .layui-form-item .tip {
            color: #666;
            font-size: 12px;
            margin-top: 5px;
            display: block;
        }
        .area-select {
            display: flex;
            gap: 10px;
        }
        .area-select .layui-select {
            flex: 1;
        }
    </style>
</head>
<body>
<div class="layui-form layuimini-form">
    <!-- 收件人信息 -->
    <div class="layui-form-item">
        <label class="layui-form-label required">收件人</label>
        <div class="layui-input-block">
            <input type="text" name="receiver" lay-verify="required" lay-reqtext="收件人姓名不能为空" 
                   placeholder="请输入收件人姓名" value="" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label required">联系电话</label>
        <div class="layui-input-block">
            <input type="tel" name="phone" lay-verify="required|phone" 
                   lay-reqtext="联系电话不能为空" lay-vertext="请输入正确的手机号码" 
                   placeholder="请输入收件人联系电话" value="" class="layui-input">
            <span class="tip">用于快递配送联系，请确保号码正确</span>
        </div>
    </div>

    <!-- 地址信息 -->
    <div class="layui-form-item">
        <label class="layui-form-label required">所在地区</label>
        <div class="layui-input-block">
            <div class="area-select">
                <select name="province" lay-verify="required" lay-reqtext="请选择省份">
                    <option value="">省份</option>
                    <option value="北京">北京</option>
                    <option value="上海">上海</option>
                    <option value="广东">广东</option>
                    <option value="江苏">江苏</option>
                    <option value="浙江">浙江</option>
                    <!-- 可根据需要补充更多省份 -->
                </select>
                <select name="city" lay-verify="required" lay-reqtext="请选择城市">
                    <option value="">城市</option>
                    <!-- 实际应用中可通过JS动态加载对应省份的城市 -->
                </select>
                <select name="district" lay-verify="required" lay-reqtext="请选择区/县">
                    <option value="">区/县</option>
                    <!-- 实际应用中可通过JS动态加载对应城市的区县 -->
                </select>
            </div>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label required">详细地址</label>
        <div class="layui-input-block">
            <textarea name="detailAddress" lay-verify="required" lay-reqtext="详细地址不能为空" 
                      placeholder="请输入街道、门牌号等详细地址信息" class="layui-textarea"></textarea>
            <span class="tip">例如：XX街道XX小区X号楼X单元XXX室</span>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">邮政编码</label>
        <div class="layui-input-block">
            <input type="text" name="zipCode" placeholder="请输入邮政编码（选填）" value="" class="layui-input">
        </div>
    </div>

    <!-- 地址设置 -->
    <div class="layui-form-item">
        <label class="layui-form-label">地址标签</label>
        <div class="layui-input-block">
            <input type="radio" name="addressTag" value="home" title="家庭" checked>
            <input type="radio" name="addressTag" value="company" title="公司">
            <input type="radio" name="addressTag" value="other" title="其他">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label"></label>
        <div class="layui-input-block">
            <input type="checkbox" name="isDefault" lay-skin="primary" title="设为默认收货地址">
        </div>
    </div>

    <!-- 操作按钮 -->
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn layui-btn-normal" lay-submit lay-filter="saveAddressBtn">确认保存</button>
            <button type="button" class="layui-btn layui-btn-primary" onclick="parent.layer.close(parent.layer.getFrameIndex(window.name))">取消</button>
        </div>
    </div>
</div>

<script src="../../lib/layui-v2.6.3/layui.js" charset="utf-8"></script>
<script>
    layui.use(['form'], function () {
        var form = layui.form,
            layer = layui.layer,
            $ = layui.$;

        // 监听省份选择，动态加载城市（示例数据）
        form.on('select(province)', function(data){
            var citySelect = $("select[name='city']");
            citySelect.html('<option value="">城市</option>');
            
            // 根据省份加载对应城市（实际项目中可通过接口获取）
            var cities = {
                "北京": ["北京市"],
                "上海": ["上海市"],
                "广东": ["广州市", "深圳市", "珠海市", "佛山市"],
                "江苏": ["南京市", "苏州市", "无锡市"],
                "浙江": ["杭州市", "宁波市", "温州市"]
            };
            
            if(cities[data.value]){
                cities[data.value].forEach(function(city){
                    citySelect.append('<option value="'+city+'">'+city+'</option>');
                });
            }
            
            form.render('select'); // 重新渲染
        });

        // 监听城市选择，动态加载区县（示例数据）
        form.on('select(city)', function(data){
            var districtSelect = $("select[name='district']");
            districtSelect.html('<option value="">区/县</option>');
            
            // 示例数据，实际项目中可通过接口获取
            var districts = {
                "北京市": ["东城区", "西城区", "朝阳区", "海淀区", "丰台区"],
                "上海市": ["黄浦区", "徐汇区", "长宁区", "静安区", "普陀区"],
                "广州市": ["天河区", "越秀区", "海珠区", "番禺区", "白云区"]
            };
            
            if(districts[data.value]){
                districts[data.value].forEach(function(district){
                    districtSelect.append('<option value="'+district+'">'+district+'</option>');
                });
            }
            
            form.render('select'); // 重新渲染
        });

        // 监听表单提交
        form.on('submit(saveAddressBtn)', function (data) {
            // 拼接完整地址
            var fullAddress = data.field.province + " " + 
                             data.field.city + " " + 
                             data.field.district + " " + 
                             data.field.detailAddress;
            
            // 显示提交信息
            var submitData = {
                ...data.field,
                fullAddress: fullAddress
            };
            
            var index = layer.alert(JSON.stringify(submitData, null, 2), {
                title: '收货地址信息确认',
                area: ['550px', '400px']
            }, function () {
                layer.close(index);
                var iframeIndex = parent.layer.getFrameIndex(window.name);
                parent.layer.close(iframeIndex);
                
                // 实际应用中可通知父页面刷新地址列表
                // parent.refreshAddressList();
            });

            return false;
        });

    });
</script>
</body>
</html>
    