<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>修改收货地址</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../lib/layui-v2.6.3/css/layui.css" media="all">
    <link rel="stylesheet" href="../../css/public.css" media="all">
    <style>
        body {
            background-color: #ffffff;
        }
        .layuimini-form .layui-form-item {
            margin-bottom: 15px;
        }
        .layui-form-label {
            width: 120px;
        }
        .layui-input-block {
            margin-left: 150px;
        }
        .tip {
            color: #666;
            font-size: 12px;
            margin-top: 5px;
            display: block;
        }
        .area-select {
            display: flex;
            gap: 10px;
        }
        .area-select .layui-select {
            flex: 1;
        }
    </style>
</head>
<body>
<div class="layui-form layuimini-form">
    <!-- 地址ID（只读） -->
    <div class="layui-form-item">
        <label class="layui-form-label">地址ID</label>
        <div class="layui-input-block">
            <input type="text" name="addressId" value="" class="layui-input" readonly>
            <tip>系统自动生成，唯一标识</tip>
        </div>
    </div>
    
    <!-- 收货人 -->
    <div class="layui-form-item">
        <label class="layui-form-label required">收货人</label>
        <div class="layui-input-block">
            <input type="text" name="receiver" lay-verify="required" lay-reqtext="收货人姓名不能为空" 
                   placeholder="请输入收货人姓名" value="" class="layui-input">
            <tip>请填写真实姓名，方便快递核对</tip>
        </div>
    </div>
    
    <!-- 联系电话 -->
    <div class="layui-form-item">
        <label class="layui-form-label required">联系电话</label>
        <div class="layui-input-block">
            <input type="tel" name="phone" lay-verify="required|phone" lay-reqtext="联系电话不能为空" 
                   placeholder="请输入联系电话" value="" class="layui-input">
            <tip>用于接收快递配送通知</tip>
        </div>
    </div>
    
    <!-- 所在地区 -->
    <div class="layui-form-item">
        <label class="layui-form-label required">所在地区</label>
        <div class="layui-input-block">
            <div class="area-select">
                <select name="province" lay-verify="required" lay-filter="province">
                    <option value="">请选择省份</option>
                    <option value="北京市" selected>北京市</option>
                    <option value="上海市">上海市</option>
                    <option value="广东省">广东省</option>
                    <option value="江苏省">江苏省</option>
                </select>
                <select name="city" lay-verify="required" lay-filter="city">
                    <option value="">请选择城市</option>
                    <option value="北京市" selected>北京市</option>
                    <option value="上海市">上海市</option>
                    <option value="广州市">广州市</option>
                    <option value="深圳市">深圳市</option>
                </select>
                <select name="district" lay-verify="required">
                    <option value="">请选择区县</option>
                    <option value="朝阳区" selected>朝阳区</option>
                    <option value="海淀区">海淀区</option>
                    <option value="东城区">东城区</option>
                    <option value="西城区">西城区</option>
                </select>
            </div>
        </div>
    </div>
    
    <!-- 详细地址 -->
    <div class="layui-form-item">
        <label class="layui-form-label required">详细地址</label>
        <div class="layui-input-block">
            <textarea name="detailAddress" lay-verify="required" lay-reqtext="详细地址不能为空" 
                      placeholder="请输入街道、门牌号等详细信息" class="layui-textarea"></textarea>
            <tip>请填写具体街道、小区名称、楼栋号、单元号和门牌号</tip>
        </div>
    </div>
    
    <!-- 邮政编码 -->
    <div class="layui-form-item">
        <label class="layui-form-label">邮政编码</label>
        <div class="layui-input-block">
            <input type="text" name="zipCode" placeholder="请输入邮政编码" value="" class="layui-input">
        </div>
    </div>
    
    <!-- 是否默认地址 -->
    <div class="layui-form-item">
        <label class="layui-form-label">默认地址</label>
        <div class="layui-input-block">
            <input type="radio" name="isDefault" value="1" title="是" checked>
            <input type="radio" name="isDefault" value="0" title="否">
            <tip>默认地址将在下单时自动选中</tip>
        </div>
    </div>

    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn layui-btn-normal" lay-submit lay-filter="saveBtn">确认保存</button>
            <button type="button" class="layui-btn layui-btn-primary" onclick="parent.layer.close(parent.layer.getFrameIndex(window.name))">取消</button>
        </div>
    </div>
</div>

<script src="../../lib/layui-v2.6.3/layui.js" charset="utf-8"></script>
<script>
    layui.use(['form', 'layer'], function () {
        var form = layui.form,
            layer = layui.layer,
            $ = layui.$;

        // 自定义验证规则
        form.verify({
            phone: function(value) {
                var reg = /^1[3-9]\d{9}$/;
                if (!reg.test(value)) {
                    return '请输入有效的11位手机号码';
                }
            }
        });

        // 省市区联动
        form.on('select(province)', function(data) {
            // 这里是模拟数据，实际项目中应从后端获取对应城市数据
            var citySelect = $('select[name="city"]');
            citySelect.html('<option value="">请选择城市</option>');
            
            if (data.value === '北京市') {
                citySelect.append('<option value="北京市">北京市</option>');
            } else if (data.value === '广东省') {
                citySelect.append('<option value="广州市">广州市</option>');
                citySelect.append('<option value="深圳市">深圳市</option>');
                citySelect.append('<option value="东莞市">东莞市</option>');
            } else if (data.value === '江苏省') {
                citySelect.append('<option value="南京市">南京市</option>');
                citySelect.append('<option value="苏州市">苏州市</option>');
            }
            
            form.render('select');
        });

        // 监听提交
        form.on('submit(saveBtn)', function (data) {
            // 模拟数据提交
            var index = layer.load(2);
            
            // 模拟异步请求
            setTimeout(function() {
                layer.close(index);
                layer.alert('地址修改成功！', {
                    title: '操作成功',
                    icon: 1
                }, function() {
                    // 关闭弹窗并刷新父页面
                    var iframeIndex = parent.layer.getFrameIndex(window.name);
                    parent.layer.close(iframeIndex);
                    parent.location.reload();
                });
            }, 800);

            return false;
        });

    });
</script>
</body>
</html>
    